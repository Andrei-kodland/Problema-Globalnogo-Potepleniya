import telebot
import random
import os
from model import get_class  # Ensure your 'get_class' function works fine
from bot_logic import gen_pass, gen_emodji, flip_coin  # Import functions from bot_logic

# Replace 'TOKEN' with your bot's token
bot = telebot.TeleBot("7989296233:AAHbLW8J_gNzrDxb4QDcFh59GpcJRsEeyo8")

@bot.message_handler(commands=['start'])
def send_welcome(message):
    bot.reply_to(message, """
–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π Telegram –±–æ—Ç. –í–æ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:
    
üîπ /hello - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
üîπ /bye - –ü—Ä–æ—â–∞–Ω–∏–µ
üîπ /pass - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–æ–ª—å
üîπ /photo - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
üîπ /emodji - –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —ç–º–æ–¥–∑–∏
üîπ /coin - –ü–æ–¥–±—Ä–æ—Å–∏—Ç—å –º–æ–Ω–µ—Ç–∫—É

üåç /deystviyaglobalpotep - –£–∑–Ω–∞—Ç—å –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö, —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—â–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –ø–æ—Ç–µ–ø–ª–µ–Ω–∏—é
üå± /antideystviyaglobalpotep - –£–∑–Ω–∞—Ç—å, –∫–∞–∫ –±–æ—Ä–æ—Ç—å—Å—è —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º –ø–æ—Ç–µ–ø–ª–µ–Ω–∏–µ–º

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –∫–æ–º–∞–Ω–¥—É, –∏ —è –ø–æ–º–æ–≥—É!
""")

@bot.message_handler(commands=['deystviyaglobalpotep'])
def send_hello(message):
    messages = [
        "–ß—Ç–æ–±—ã —Å–ø–æ—Å–æ–±—Å—Ç–≤–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –ø–æ—Ç–µ–ø–ª–µ–Ω–∏—é –∏ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –µ–≥–æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤—É—é—Ç –Ω–∞ –∫–ª–∏–º–∞—Ç. –í–æ-–ø–µ—Ä–≤—ã—Ö, —Å–∂–∏–≥–∞–Ω–∏–µ –∏—Å–∫–æ–ø–∞–µ–º—ã—Ö –≤–∏–¥–æ–≤ —Ç–æ–ø–ª–∏–≤–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ —É–≥–æ–ª—å, –Ω–µ—Ñ—Ç—å –∏ –≥–∞–∑, –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —ç–Ω–µ—Ä–≥–∏–∏, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—ã–±—Ä–æ—Å—ã —É–≥–ª–µ–∫–∏—Å–ª–æ–≥–æ –≥–∞–∑–∞ (CO‚ÇÇ) –∏ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–Ω–∏–∫–æ–≤—ã—Ö –≥–∞–∑–æ–≤ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É.",
        "–í—ã—Ä—É–±–∫–∞ –ª–µ—Å–æ–≤ —Ç–∞–∫–∂–µ –∏–≥—Ä–∞–µ—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å, —Ç–∞–∫ –∫–∞–∫ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ –¥–µ—Ä–µ–≤—å–µ–≤ —É–º–µ–Ω—å—à–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ó–µ–º–ª–∏ –ø–æ–≥–ª–æ—â–∞—Ç—å —É–≥–ª–µ—Ä–æ–¥ –∏ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç –≤—ã–±—Ä–æ—Å—É CO‚ÇÇ. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫, —Ç–∞–∫–∏—Ö –∫–∞–∫ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–¥–æ–±—Ä–µ–Ω–∏–π, –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ –∏ –≤—ã—Ä—É–±–∫–∞ –ª–µ—Å–æ–≤ –ø–æ–¥ —Å–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ, –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–±—Ä–æ—Å–∞–º –º–µ—Ç–∞–Ω–∞ –∏ –∑–∞–∫–∏—Å–∏ –∞–∑–æ—Ç–∞.",
        "–ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç—Ö–æ–¥–æ–≤ –Ω–∞ —Å–≤–∞–ª–∫–∞—Ö —Ç–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç –≤—ã–±—Ä–æ—Å—ã –º–µ—Ç–∞–Ω–∞, –º–æ—â–Ω–æ–≥–æ –ø–∞—Ä–Ω–∏–∫–æ–≤–æ–≥–æ –≥–∞–∑–∞. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ —Å –¥–≤–∏–≥–∞—Ç–µ–ª—è–º–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–≥–æ—Ä–∞–Ω–∏—è –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã —É–≥–ª–µ–∫–∏—Å–ª—ã–º –≥–∞–∑–æ–º.",
        "–ù–µ—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–æ–¥—ã, –≤—ã–∫–∞—á–∫–∞ –≤–æ–¥—ã –¥–ª—è —Å–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞ –∏ –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã—Ö –Ω—É–∂–¥ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∑–∞—Ç—Ä–∞—Ç–∞–º —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –µ–µ –æ—á–∏—Å—Ç–∫–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏. –ù–∞–∫–æ–Ω–µ—Ü, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –≤—Ä–µ–¥–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ —Ä–µ—Å—É—Ä—Å—ã, –∞ —Ç–∞–∫–∂–µ –æ—Ç–∫–∞–∑ –æ—Ç –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–æ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—é –≤—ã–±—Ä–æ—Å–æ–≤ –ø–∞—Ä–Ω–∏–∫–æ–≤—ã—Ö –≥–∞–∑–æ–≤, —É—Å–∏–ª–∏–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∏–º–∞—Ç–∞ –∏ —É—Ö—É–¥—à–∞—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã."
    ]
    
    random_message = random.choice(messages)
    bot.reply_to(message, random_message)

@bot.message_handler(commands=['antideystviyaglobalpotep'])
def send_hello(message):
    messages = [
        "–ß—Ç–æ–±—ã –ø–æ–º–æ—á—å –≤ –±–æ—Ä—å–±–µ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º –ø–æ—Ç–µ–ø–ª–µ–Ω–∏–µ–º –∏ —É–º–µ–Ω—å—à–∏—Ç—å –µ–≥–æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è, –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –í–æ-–ø–µ—Ä–≤—ã—Ö, —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —ç–Ω–µ—Ä–≥–∏–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–ª–Ω–µ—á–Ω–∞—è, –≤–µ—Ç—Ä—è–Ω–∞—è –∏–ª–∏ –≥–∏–¥—Ä–æ—ç–Ω–µ—Ä–≥–∏—è, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—ã, —Å–ø–æ—Å–æ–±—Å—Ç–≤—É—é—â–∏–µ –∏—Ö —Ä–∞–∑–≤–∏—Ç–∏—é. –£–ª—É—á—à–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–Ω–µ—Ä–≥–æ—ç–∫–æ–Ω–æ–º–Ω—ã—Ö –ø—Ä–∏–±–æ—Ä–æ–≤, —Å–≤–µ—Ç–æ–¥–∏–æ–¥–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è –∏ –ª—É—á—à–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–æ–º–∞ —Ç–∞–∫–∂–µ –ø–æ–º–æ–≥—É—Ç —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏.",
        "–í–∞–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å —É—Å—Ç–æ–π—á–∏–≤—ã–µ –≤–∏–¥—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º, –µ–∑–¥–∏—Ç—å –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥–µ, —Ö–æ–¥–∏—Ç—å –ø–µ—à–∫–æ–º –∏–ª–∏ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Å—Ç–æ–∏—Ç —Å–∞–∂–∞—Ç—å –¥–µ—Ä–µ–≤—å—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É—Å–∏–ª–∏—è –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ª–µ—Å–æ–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –ø–æ–≥–ª–æ—â–∞—é—Ç CO‚ÇÇ.",
        "–°–Ω–∏–∂–µ–Ω–∏–µ –æ—Ç—Ö–æ–¥–æ–≤, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –æ—Ç–∫–∞–∑ –æ—Ç –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –ø–ª–∞—Å—Ç–∏–∫–∞ –ø–æ–º–æ–≥—É—Ç —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º—É—Å–æ—Ä–∞ –Ω–∞ —Å–≤–∞–ª–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–¥–µ–ª—è—é—Ç –º–µ—Ç–∞–Ω. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Å–µ–ª—å—Å–∫–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞, –≤—ã–±–æ—Ä —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–π –ø–∏—â–∏ –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –ø–∏—â–µ–≤—ã—Ö –æ—Ç—Ö–æ–¥–æ–≤ —Ç–∞–∫–∂–µ –∏–≥—Ä–∞—é—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å –≤ –±–æ—Ä—å–±–µ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫–ª–∏–º–∞—Ç–∞.",
        "–≠–∫–æ–Ω–æ–º–∏—è –≤–æ–¥—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–æ–¥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã—Ö –±–∏–∑–Ω–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —ç–Ω–µ—Ä–≥–∏–∏, —Ç–∞–∫–∂–µ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏—é —É–≥–ª–µ—Ä–æ–¥–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤. –ù–∞–∫–æ–Ω–µ—Ü, –≤–∞–∂–Ω–æ –ø–æ–≤—ã—à–∞—Ç—å –æ—Å–≤–µ–¥–æ–º–ª–µ–Ω–Ω–æ—Å—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–ª–∏–º–∞—Ç–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ –≤—ã—Å—Ç—É–ø–∞—Ç—å –∑–∞ –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –º–µ—Ä—ã –ø–æ –∑–∞—â–∏—Ç–µ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã."
    ]
    
    random_message = random.choice(messages)
    bot.reply_to(message, random_message)
    
@bot.message_handler(content_types=['photo'])
def handle_photo(message):
    try:
        if not message.photo:
            bot.send_message(message.chat.id, "You forgot to upload a picture. Please try again!")
            return

        file_info = bot.get_file(message.photo[-1].file_id)
        file_name = file_info.file_path.split('/')[-1]

        downloaded_file = bot.download_file(file_info.file_path)
        local_path = f'./images/{file_name}'
        os.makedirs(os.path.dirname(local_path), exist_ok=True)
        
        with open(local_path, 'wb') as new_file:
            new_file.write(downloaded_file)

        model_path = r"C:\Users\1505105\OneDrive\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\Ai bot\keras_model.h5"
        labels_path = r"C:\Users\1505105\OneDrive\–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª\Ai bot\labels.txt"
        result = get_class(model_path=model_path, labels_path=labels_path, image_path=local_path)

        if isinstance(result, tuple):
            label = result[0]
        else:
            label = result

        if label is None:
            bot.send_message(message.chat.id, "Unable to classify the image. Please try again.")
            return

        if isinstance(label, str):
            if label.lower() == "bad":
                bot.send_message(message.chat.id, "This image is bad for global warming.")
            elif label.lower() == "good":
                bot.send_message(message.chat.id, "This image is good for global warming.")
            else:
                bot.send_message(message.chat.id, f"Unrecognized label: {label}")
        else:
            bot.send_message(message.chat.id, "The result from the model was not in the expected format.")

    except Exception as e:
        bot.send_message(message.chat.id, f"Something went wrong while processing the image. Error: {e}")

@bot.message_handler(commands=['bye'])
def send_bye(message):
    bot.reply_to(message, "–ü–æ–∫–∞! –£–¥–∞—á–∏!")

@bot.message_handler(commands=['pass'])
def send_password(message):
    password = gen_pass(10)
    bot.reply_to(message, f"–í–æ—Ç —Ç–≤–æ–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å: {password}")

@bot.message_handler(commands=['emodji'])
def send_emodji(message):
    emodji = gen_emodji()
    bot.reply_to(message, f"–í–æ—Ç —ç–º–æ–¥–∂–∏': {emodji}")

@bot.message_handler(commands=['coin'])
def send_coin(message):
    coin = flip_coin()
    bot.reply_to(message, f"–ú–æ–Ω–µ—Ç–∫–∞ –≤—ã–ø–∞–ª–∞ —Ç–∞–∫: {coin}")

# –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
bot.polling()





        

